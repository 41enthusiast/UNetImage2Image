/home3/txlx81/UNetImage2Image/uneti2i/lib/python3.11/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home3/txlx81/UNetImage2Image/uneti2i/lib/python3.11/site-packages/torch/utils/data/dataloader.py:627: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
wandb: WARNING The anonymous setting has no effect and will be removed in a future version.
wandb: Currently logged in as: mridulav to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run gabgiwp3
wandb: Tracking run with wandb version 0.23.1
wandb: Run data is saved locally in logs/wandb/run-20251225_094321-gabgiwp3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run unet_swin_41M
wandb: â­ï¸ View project at https://wandb.ai/mridulav/unet_i2i
wandb: ðŸš€ View run at https://wandb.ai/mridulav/unet_i2i/runs/gabgiwp3
/home3/txlx81/UNetImage2Image/uneti2i/lib/python3.11/site-packages/torch/functional.py:505: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4317.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/home3/txlx81/UNetImage2Image/uneti2i/lib/python3.11/site-packages/lightning_fabric/connector.py:571: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
/home3/txlx81/UNetImage2Image/uneti2i/lib/python3.11/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3 train.py ...
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
You are using a CUDA device ('NVIDIA A100 80GB PCIe') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home3/txlx81/UNetImage2Image/uneti2i/lib/python3.11/site-packages/pytorch_lightning/utilities/model_summary/model_summary.py:242: Precision 16-mixed is not supported by the model summary.  Estimated model size in MB will not be accurate. Using 32 bits instead.

  | Name  | Type                             | Params | Mode  | FLOPs
---------------------------------------------------------------------------
0 | model | SwinUnet                         | 41.4 M | train | 0    
1 | MSE   | MSELoss                          | 0      | train | 0    
2 | psnr  | PeakSignalNoiseRatio             | 0      | train | 0    
3 | ssim  | StructuralSimilarityIndexMeasure | 0      | train | 0    
---------------------------------------------------------------------------
41.4 M    Trainable params
0         Non-trainable params
41.4 M    Total params
165.520   Total estimated model params size (MB)
384       Modules in train mode
0         Modules in eval mode
0         Total Flops
/home3/txlx81/UNetImage2Image/uneti2i/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:485: Your `val_dataloader`'s sampler has shuffling enabled, it is strongly recommended that you turn shuffling off for val/test dataloaders.
/home3/txlx81/UNetImage2Image/uneti2i/lib/python3.11/site-packages/torch/utils/data/dataloader.py:627: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
/home3/txlx81/UNetImage2Image/uneti2i/lib/python3.11/site-packages/pytorch_lightning/loops/fit_loop.py:317: The number of training batches (5) is smaller than the logging interval Trainer(log_every_n_steps=10). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Metric val_loss improved. New best score: 0.311
Metric val_loss improved by 0.064 >= min_delta = 0.0. New best score: 0.247
Metric val_loss improved by 0.154 >= min_delta = 0.0. New best score: 0.093
Metric val_loss improved by 0.021 >= min_delta = 0.0. New best score: 0.071
Metric val_loss improved by 0.009 >= min_delta = 0.0. New best score: 0.062
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.061
Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: 0.058
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.057
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.056
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.055
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.054
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.054
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.053
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.053
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.052
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.052
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.052
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.051
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.051
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.050
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.050
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.049
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.049
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.048
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.048
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.047
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.046
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.045
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.045
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.044
Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.041
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.040
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.039
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.038
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.038
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.037
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.036
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.036
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.035
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.035
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.035
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.035
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.035
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.034
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.034
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.034
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.033
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.033
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.033
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.033
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.032
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.032
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.032
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.032
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.032
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.032
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.032
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.032
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.032
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.032
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.031
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.031
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.031
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.030
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.030
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.030
Monitored metric val_loss did not improve in the last 10 records. Best score: 0.030. Signaling Trainer to stop.
